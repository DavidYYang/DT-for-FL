<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css">
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Demo Tree</title>
    <!-- <script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.0/jquery.min.js"></script> -->



    
    {% comment %} <script type="text/javascript" src="scripts/jquery-ui-1.10.4.custom.min.js"></script>
    <script type="text/javascript" src="required/script/jquery.connectingLine.js"></script>  {% endcomment %}
    {% load static %}
    <link href="{% static 'mainpage.css'%}" rel="stylesheet">
    <script type="text/javascript" src="{% static 'jquery-1.11.0.min.js' %}"></script>  
    <script type="text/javascript" src="{% static 'jquery.connectingLine.js' %}"></script>
    <style type="text/css">
        body
        {
            padding:0px;
            margin:0px;
            background: #FFF;
        }
        #centerprogress{
            position: absolute;
            margin-left: 1400px;
            margin-top: 140px;
        }
        
        #addDeviceDiv{
            margin-left: 410px;
            margin-top: 200px;
            position: absolute;
            width: 400px;
            border: 1px solid #ccc;
            border-radius: 10%;
            padding: 40px;
            background: #D8DBD7;
            border: 1px solid #37762E;


        }
        #addGatewayDiv{
            margin-left: 410px;
            margin-top: 200px;
            position: absolute;
            width: 400px;
            border: 1px solid #ccc;
            border-radius: 10%;
            padding: 40px;
            background: #D8DBD7;
            border: 1px solid #37762E;
        }
        #diveServerInfo{
            margin-left: 1300px;
            margin-top: 300px;
            position: absolute;
            width: 300px;
            border: 1px solid #ccc;
            border-radius: 100%;
            padding: 40px;
            background: #E9F7EF;
            border: 1px solid #0E6655;
        }
        #sidebar{
            margin-left: 10px;
            margin-top: 230px;
            position: absolute;
            width: 300px;
            border: 1px solid #ccc;
            border-radius: 10%;
            padding: 40px;
            background: #D8DBD7;
            border: 2px solid #37762E;

        }
        .view_device_span{
             color: green;
             font-weight: bold;
        }
        .btn-outline-danger{
            width: 200px;
        }
        .gradientText{
            font-size: 19px; 
            font-weight: bold; 
            background: -webkit-linear-gradient(left, #a445b2, #fa4299);
            -webkit-background-clip: text; 
            -webkit-text-fill-color: transparent;
        }
    </style>
    <!-- <link href="css/stylee.css" rel="stylesheet" type="text/css" />  -->
    
    
    

</head>
<body>
    {% csrf_token %}
    <div id= 'sidebar'>
        <center><h2>Select Option</h2> <br> <br>
        <button id = "addDevice" class = 'btn btn-outline-danger'>Add Device <span id='spanAddDevice' style='font-size: 10' class="badge badge-success">Show</span></button> <br> <br><br>
        <button id = "addGateway" class = 'btn btn-outline-danger'>Add Gateway <span id='spanAddGateway' style='font-size: 10' class="badge badge-success">Show</span></button> <br>
    </center>
    </div>

    {% comment %} <div class="sidenav">
        <a id = "addDevice" href="#">Add Device<span style='font-size: 10' class="badge badge-primary">Show</span></a>
        <a id = "addGateway" href="#">Add Gateway<span class="badge badge-primary">Show</span></a>
        <a href="#">Clients</a>
        <a href="#">Contact</a>
    </div> {% endcomment %}
    <div id="addDeviceDiv">
              <div class="form-group">
                <h2>Add Device</h2>
                <label for="exampleInputEmail1">IP Address</label>
                <input type="text" class="form-control" id="exampleInputEmail1" aria-describedby="emailHelp" placeholder="192.168.0.1">
                <small id="emailHelp" class="form-text text-muted">The device with the enterted IP address should be in the same network</small>
                <label for="txtDevicePort">Port</label>
                <input type="text" class="form-control" id="txtDevicePort" aria-describedby="emailHelp" placeholder="1234">
              </div>
            
              <center><button ID ='btnAddDevice' class="btn btn-primary">Add Device</button></center>
    </div>

    <div id="addGatewayDiv">
              <div class="form-group">
                <h2>Add Gateway</h2>
                <label for="exampleInputEmail1">IP Address</label>
                <input type="text" class="form-control" id="txtGatewayIP" aria-describedby="emailHelp" placeholder="192.168.0.1">
                <small id="emailHelp" class="form-text text-muted">The Gateway with the enterted IP address should be in the same network</small>
                <label for="txtGatewayPort">Port</label>
                <input type="text" class="form-control" id="txtGatewayPort" aria-describedby="emailHelp" placeholder="1234">
              </div>
            
              <center><button ID = 'btnAddGateway' class="btn btn-primary">Add Gateway</button>
                <p id='errorGateway' style='color:red'></p>
            </center>

    </div>

    <div id = 'diveServerInfo'>
        <center><span id = 'deviceTask_Show' class = 'gradientText'>Server</span></center> </br>
        <span class = 'gradientText'>IP Address:</span><span id = 'deviceIP_Show'>192.168.3.11</span> </br>
        <span class = 'gradientText'>Port:</span><span id = 'devicePort_Show'></span>1298 </br>
        <span class = 'gradientText'>Number of Devices:</span><span id = 'deviceStatus_Show'></span> 5</br>
    </div>
    
    <div class="wrapper" id="centerprogress">
        <div class="card">
            <div class="circle circlecenter" >
                <div class="bar"></div>
                <div class="box"><span class="centerSpan"></span></div>
            </div>
            <center><div class="text">Training Progress</div></venter>
        </div>
    </div>
    <div style= 'width: 2px; height: 100%; position: absolute; margin-left: 50%; background: #000;  '></div>
    {% load static %}


    <div style=' margin-top:20px; position: absolute; margin-left: 1000px;'>
        <div class="wrapper" id="ss">
            <div class="card">
                <div class="circle circlecenter" >
                    <div class="bar"></div>
                    <div class="box"><span class="centerSpan"></span></div>
                </div>
                <center><div class="text">Training Progress</div></venter>
            </div>
        </div>
        <img class= 'raspImg' src= "{%static 'image.jpg'%}" style='height: 70px; width: 120px;' /><br>
        <span class='gradientText'>192.168.0.6:5000</span>
    </div>
    <div style=' margin-top:480px; position: absolute; margin-left: 1000px;'>
        <div class="wrapper" id="ss">
            <div class="card">
                <div class="circle circlecenter" >
                    <div class="bar"></div>
                    <div class="box"><span class="centerSpan"></span></div>
                </div>
                <center><div class="text">Training Progress</div></venter>
            </div>
        </div>
        <img class= 'raspImg' src= "{%static 'image.jpg'%}" style='height: 70px; width: 120px;' /><br>
        <span class='gradientText'>192.168.0.11:5000</span>
    </div>
    <div style=' margin-top:20px; position: absolute; margin-left: 1700px;'>
        <div class="wrapper" id="ss">
            <div class="card">
                <div class="circle circlecenter" >
                    <div class="bar"></div>
                    <div class="box"><span class="centerSpan"></span></div>
                </div>
                <center><div class="text">Training Progress</div></venter>
            </div>
        </div>
        <img class= 'raspImg' src= "{%static 'image.jpg'%}" style='height: 70px; width: 120px;' /><br>
        <span class='gradientText'>192.168.0.18:5000</span>
    </div>
    <div style=' margin-top:480px; position: absolute; margin-left: 1700px;'>
        <div class="wrapper" id="ss">
            <div class="card">
                <div class="circle circlecenter" >
                    <div class="bar"></div>
                    <div class="box"><span class="centerSpan"></span></div>
                </div>
                <center><div class="text">Training Progress</div></venter>
            </div>
        </div>
        <img class= 'raspImg' src= "{%static 'image.jpg'%}" style='height: 70px; width: 120px;' /><br>
        <span class='gradientText'>192.168.0.14:5000</span>
    </div>

   




        <!-- <div class="container">
          <div class="button-container"><button>Register</button></div>
          <div class="button-container"><button>Log In</button></div>
        </div> -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-circle-progress/1.2.2/circle-progress.min.js"></script>
        <script type='text/javascript'>
            let options = {
                startAngle: -1.55,
                size: 70,
                value: 0.56,
                fill: {gradient: ['#a445b2', '#fa4299']}
            }
            $(".circlecenter .bar").circleProgress(options).on('circle-animation-progress',
                function(event, progress, stepValue){
                    $(this).parent().find(".centerSpan").text(String(stepValue.toFixed(2).substr(2)) + "%");
                });
            
            var mySVG = $('body').connect();

            mySVG.drawLine({
                left_node:'#diveServerInfo',
                right_node:'.raspImg',
                status: 'accepted',
                horizantal_gap:20,
                style: 'solid',
                error: 'hide',
                width:5,
                type:'A'
            });


            $('#addGatewayDiv').hide();
            $('#addDeviceDiv').hide();
            $('#addDevice').click(function(){
                $('#spanAddGateway').text('Show');
                $('#spanAddGateway').removeClass('badge-dark');
                $('#spanAddGateway').addClass('badge-success');


                var txtSpan = $('#spanAddDevice').text();
                if(txtSpan == 'Show'){
                    $('#spanAddDevice').text('Hide');
                    $('#spanAddDevice').addClass('badge-dark');
                    $('#spanAddDevice').removeClass('badge-success');
                }else{
                    $('#spanAddDevice').text('Show');
                    $('#spanAddDevice').removeClass('badge-dark');
                    $('#spanAddDevice').addClass('badge-success');
                }
                $('#spanAddDevice').addClass('badge-success');
                $('#addGatewayDiv').hide(1000);
                $('#addDeviceDiv').toggle(1000);
            });
            $('#addGateway').click(function(){
                
                $('#spanAddDevice').removeClass('badge-dark');
                $('#spanAddDevice').addClass('badge-success');
                $('#spanAddDevice').text('Show');

                var txtSpan = $('#spanAddGateway').text();
                if(txtSpan == 'Show'){
                    $('#spanAddGateway').text('Hide');
                    $('#spanAddGateway').addClass('badge-dark');
                    $('#spanAddGateway').removeClass('badge-success');
                }else{
                    $('#spanAddGateway').text('Show');
                    $('#spanAddGateway').removeClass('badge-dark');
                    $('#spanAddGateway').addClass('badge-success');
                }

                $('#addDeviceDiv').hide(1000);
                $('#addGatewayDiv').toggle(1000);
            });


            $('#btnAddGateway').on('click', function(){
                var ipTester = 
                /^(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])$/;
                if(!$('#txtGatewayIP').val() ){
                    $('#errorGateway').text('Please Enter IP Address')
                    return
                }
                if (!ipTester.test($('#txtGatewayIP').val())){
                    $('#errorGateway').text('IP Address is not valid')
                    return
                }
                if(!$('#txtGatewayPort').val() ){
                    $('#errorGateway').text('Please Enter Port')
                    return
                }
                var csrf = $('input[name =csrfmiddlewaretoken]').val();
                $.ajax({
                    data: {
                        ip_address: $('#txtGatewayIP').val(),
                        port: $('#txtGatewayPort').val(),
                        csrfmiddlewaretoken : csrf
                    },
                    type: 'POST',
                    url: '/addGateway'
                }).done(function(data){
                    if(data.status ==1){
                        alert(data.status)
                    }else{
                        $('#errorGateway').text($('#txtGatewayIP').val()+' is down!')
                    }
                    
                });


            });
        </script>
    </body>
    </html>